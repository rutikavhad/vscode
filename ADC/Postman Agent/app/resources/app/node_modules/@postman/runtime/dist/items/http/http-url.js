"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.prepareURL = prepareURL;
const urls_1 = require("../../lib/urls");
/**
 * Prepare URL from given HTTP request payload
 *
 * 1. Parse URL (with URL encoding based on setting)
 * 2. Set path variables
 * 3. Add explicit query parameters
 */
function prepareURL(payload) {
    const { pathVariables = [], queryParams = [] } = payload;
    const urlEncoding = !payload.settings?.disableUrlEncoding;
    const url = (0, urls_1.parseURL)(payload.url, { urlEncoding });
    let { pathname, search } = url;
    // Set path variables in url.pathname
    pathname = (0, urls_1.replacePathVariables)(pathname, pathVariables);
    // Add query parameters to url.search
    search = (0, urls_1.setQueryParameters)(search, queryParams, { urlEncoding });
    const href = (0, urls_1.toHref)({ ...url, pathname, search });
    return { ...url, pathname, search, href };
}
//# sourceMappingURL=http-url.js.map