"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.dispose = dispose;
// Polyfill Symbol.dispose / Symbol.asyncDispose
//
// From https://www.typescriptlang.org/docs/handbook/release-notes/typescript-5-2.html
// and https://github.com/hazae41/symbol-dispose-polyfill/blob/b86100ce3d87eb80f7e6096b6bc38dd1d8845c57/src/mods/symbol-dispose-polyfill/polyfill.ts (MIT)
/* v8 ignore next 10 */
if (typeof Symbol.dispose !== 'symbol') {
    Object.defineProperty(Symbol, 'dispose', {
        value: Symbol.for('Symbol.dispose'),
    });
}
if (typeof Symbol.asyncDispose !== 'symbol') {
    Object.defineProperty(Symbol, 'asyncDispose', {
        value: Symbol.for('Symbol.asyncDispose'),
    });
}
/**
 * Explicitly dispose resources using https://github.com/tc39/proposal-explicit-resource-management
 * (Stage 3 TC39 proposal, so will likely need polyfill for use)
 */
async function dispose(value) {
    if (isAsyncDisposable(value)) {
        await value[Symbol.asyncDispose]();
    }
    else if (isDisposable(value)) {
        value[Symbol.dispose]();
    }
}
function isDisposable(value) {
    return (value != null &&
        typeof value === 'object' &&
        Symbol.dispose in value &&
        typeof value[Symbol.dispose] === 'function');
}
function isAsyncDisposable(value) {
    return (value != null &&
        typeof value === 'object' &&
        Symbol.asyncDispose in value &&
        typeof value[Symbol.asyncDispose] === 'function');
}
//# sourceMappingURL=disposables.js.map