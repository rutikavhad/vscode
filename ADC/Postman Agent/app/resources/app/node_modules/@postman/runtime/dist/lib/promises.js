"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.promiseWithResolvers = promiseWithResolvers;
exports.isPromise = isPromise;
exports.promisify = promisify;
/**
 * Polyfill for Promise.withResolvers
 * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/withResolvers
 *
 * Baseline 2024 (available in Node.js 22+)
 */
function promiseWithResolvers() {
    let resolve;
    let reject;
    const promise = new Promise((_resolve, _reject) => {
        resolve = _resolve;
        reject = _reject;
    });
    return { promise, resolve: resolve, reject: reject };
}
/**
 * Check if the given value is a Promise or Thenable
 */
function isPromise(value) {
    if (value instanceof Promise)
        return true;
    // Check if value is a thenable
    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables
    return (typeof value === 'object' &&
        value !== null &&
        typeof value.then === 'function');
}
/**
 * Convert callback-based method to Promise-based
 */
function promisify(fn) {
    return (...args) => {
        return new Promise((resolve, reject) => {
            fn(...args, (error, result) => {
                if (error) {
                    return reject(error);
                }
                resolve(result);
            });
        });
    };
}
//# sourceMappingURL=promises.js.map