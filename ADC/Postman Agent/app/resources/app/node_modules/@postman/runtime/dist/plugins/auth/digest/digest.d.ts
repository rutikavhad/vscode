import type { KeyValues } from '@postman/runtime.models';
import * as z from 'zod/v4-mini';
import { type HashAlgorithm } from '../../../lib/crypto/hashing';
import type { MaybePromise } from '../../../lib/promises';
export declare const DigestAlgorithm: z.ZodMiniLiteral<"MD5" | "SHA-256" | "MD5-sess" | "SHA-256-sess" | "SHA-512-256" | "SHA-512-256-sess">;
export type DigestAlgorithm = z.infer<typeof DigestAlgorithm>;
export interface DigestParameters {
    nonce: string;
    realm: string;
    qop?: string;
    opaque?: string;
    clientNonce?: string;
    nonceCount?: string;
}
/**
 * Generate a Digest authorization header
 *
 * https://datatracker.ietf.org/doc/html/rfc2617#section-3.2.2
 */
export declare function generateDigestAuthorization(params: {
    algorithm?: DigestAlgorithm;
    username: string;
    password: string;
    nonce: string;
    realm: string;
    qop?: string;
    opaque?: string;
    clientNonce?: string;
    nonceCount?: string;
    /**
     * HTTP method
     */
    method: string;
    /**
     * HTTP `absoluteURI | abs_path` where:
     *
     * ```
     * absoluteURI   = scheme ":" ( hier_part | opaque_part )
     * abs_path      = "/"  path_segments
     * ```
     *
     * From https://datatracker.ietf.org/doc/html/rfc2396#section-3
     */
    uri: string;
    /**
     * When using integrity protection, get a digest hash of the body
     */
    body?: (hashAlgorithm: HashAlgorithm) => MaybePromise<string | undefined>;
}): Promise<string>;
/**
 * Find the www-authenticate header (matching the given algorithm) in the given headers
 *
 * @param headers key-value headers
 * @param {DigestAlgorithm} [algorithm]
 * @returns
 */
export declare function findDigestChallenge(headers: KeyValues, algorithm?: DigestAlgorithm): string | null;
/**
 * Decode Digest authentication parameters from www-authenticate header
 */
export declare function parseDigestChallenge(header: string): DigestParameters;
export declare function parseNonceCount(value?: string): number;
export declare function formatNonceCount(value: number): string;
